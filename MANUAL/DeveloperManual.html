

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Developer Manual &mdash; EXT: Stored Procedures from TypoScript (esp)</title>
    
    <link rel="stylesheet" href="_static/typo3sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="EXT: Stored Procedures from TypoScript (esp)" href="index.html" />
    <link rel="next" title="Integrator Manual" href="IntegratorManual.html" />
    <link rel="prev" title="Administrator Manual" href="AdministratorManual.html" /> 
  </head>
  <body>
<div id="logo-div">
  <a href="index.html" title="Start">
    <img id="logo-img" src="_static/typo3-logo.png" 
         border="0" alt="TYPO3 Logo" />
  </a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="IntegratorManual.html" title="Integrator Manual"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="AdministratorManual.html" title="Administrator Manual"
             accesskey="P">previous</a> |</li>
  <li><a href="index.html">home</a>|&nbsp;</li>
  <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Developer Manual</a><ul>
<li><a class="reference internal" href="#stored-procedures">Stored procedures</a><ul>
<li><a class="reference internal" href="#editing-stored-procedures">Editing stored procedures</a></li>
<li><a class="reference internal" href="#getting-started">Getting started</a></li>
<li><a class="reference internal" href="#guidelines">Guidelines</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="AdministratorManual.html"
                        title="previous chapter">Administrator Manual</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="IntegratorManual.html"
                        title="next chapter">Integrator Manual</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/DeveloperManual.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="developer-manual">
<h1>Developer Manual<a class="headerlink" href="#developer-manual" title="Permalink to this headline">¶</a></h1>
<div class="section" id="stored-procedures">
<h2>Stored procedures<a class="headerlink" href="#stored-procedures" title="Permalink to this headline">¶</a></h2>
<div class="section" id="editing-stored-procedures">
<h3>Editing stored procedures<a class="headerlink" href="#editing-stored-procedures" title="Permalink to this headline">¶</a></h3>
<p>To quickly fix a stored procedure you can use phpMyAdmin or adminer.
A more comfortable IDE for the development of SQL including stored procedures
is MySQL Workbench.</p>
<p>The classical way is, to write stored procedures using your preferred text
editor and to apply them by using the commandline tool <strong>mysql</strong>, similar
to this:</p>
<div class="highlight-python"><pre>cat your_procedures.sql | mysql -u root -p secret -D typo3</pre>
</div>
</div>
<div class="section" id="getting-started">
<h3>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h3>
<p>To find examples take a look into <strong>EXT:esp/ext_procedures.sql</strong>.</p>
</div>
<div class="section" id="guidelines">
<h3>Guidelines<a class="headerlink" href="#guidelines" title="Permalink to this headline">¶</a></h3>
<p>1.) Prepend the name of your stored procedure with your extension key to avoid
naming conflicts. Best practice:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">tx_extkey_yourprocedure</span>
</pre></div>
</div>
<p>2.) Recieve the table name as the first parameter of the procedure:</p>
<div class="highlight-python"><pre>DELIMITER $$
CREATE PROCEDURE `tx_extkey_yourprocedure` (IN tableName VARCHAR(255), ... more parameters ....)
BEGIN
        ... your code here
END$$
DELIMITER ;</pre>
</div>
<p>Mind the whitespace after DELIMITER: DELIMITER[space]$$ and DELIMITER[space];</p>
<p>3.) Create the temporary table definition query with tableName by use of concat:</p>
<div class="highlight-python"><pre>SET @query = concat("CREATE TEMPORARY TABLE ", @tableName, " ... your table definition ...");
PREPARE stmt FROM @query;
EXECUTE stmt;
DEALLOCATE PREPARE stmt;</pre>
</div>
<p>Hint:</p>
<div class="highlight-python"><pre>Even if you create a permanet table, you will not see it in the database,
because the table of tableName is cleaned up by the calling PHP class afterwards.</pre>
</div>
<p>4.) Prevent SQL injections by escaping yout queries where necessary:</p>
<div class="highlight-python"><pre>TODO: how to do this</pre>
</div>
<p>5.) Write your code. This technology is rather recommended for read access than for write access.
As you circumvent the TCE it&#8217;s completly up to you to build the right queries.
You need deep knowledge of the data model of TYPO3, if you want to modify data of existing tabels.
It is recomended to use the TCE for to modify data as long as you don&#8217;t know exactly what you do.</p>
<p>6.) Document your code. Use speaking names. Because SQL is not a very human readable language
provide comments what your queries do. You will be thankfull within a few months.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="IntegratorManual.html" title="Integrator Manual"
             >next</a> |</li>
        <li class="right" >
          <a href="AdministratorManual.html" title="Administrator Manual"
             >previous</a> |</li>
  <li><a href="index.html">home</a>|&nbsp;</li>
  <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright .
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>